<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>untitled</title>
	<meta name="generator" content="TextMate http://macromates.com/">
	<meta name="author" content="cla">
	<script src='js/jquery-1.10.1.min.js' type='text/javascript'></script>
</head>
<body>
<pre id="result">
		<script type='text/javascript'>
		var i,j;
		var json=[];
		console.log();
		$.get('http://localhost:8888/lces_log2lces_json/SEBmisc.log', function(s) {
//Wed May 29 02:47:24 CEST 2013;INFO;SALJSTOD;AD;multiExMerge;/Applications/A7510/1.0/A7510.xdp;successful pages:3
//Wed May 29 06:41:56 CEST 2013;INFO;SALJSTOD;AD;multiExMerge;/Applications/A7510/1.0/A7510.xdp;successful pages:3
			var lines = s.split("\n");
			for (i=0;i<lines.length;i++) {
				var o = {};
				var line = lines[i].split(";");
				if (line[1] == "INFO") {
					if (line[2] == "SALJSTOD" && line[3] == "AD") {
						// get date
						var timestamp = new Date(line[0].replace(/CEST/, '+0200'));
						o.timestamp = timestamp.getTime();

						// formid
						o.formid = line[5].split("/")[2];
						var temp;
						if (temp = line[6].match(/pages:(\d)/)) {
							o.pages = temp[1];
						}
						// channel
						switch(line[4]) {
							case "xml2pdf": o.channel = "Telefonbanken"; break;
							case "singleExMergeA7479": o.channel = "Telefonbanken"; break;
							case "multiExMerge": o.channel = "Kontor"; break;
							case "multiExMergeA7479": o.channel = "Kontor"; break;
						}
						json.push(o);

					} else {/*NOT ;SALJSTOD;*/}
				} else {/*;ERROR;*/}
			}
			document.write(JSON.stringify(json));
		});
		</script>
</pre>
</body>
</html>
